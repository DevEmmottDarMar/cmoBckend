{
  "info": {
    "name": "ğŸ”„ Flujos Completos - Project EQU",
    "description": "ColecciÃ³n completa organizada en flujos separados para probar toda la funcionalidad del sistema",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3001",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "tecnico_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "supervisor_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "admin_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "tecnico_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "supervisor_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "trabajo_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "permiso_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "ğŸ” FLUJO 1: AutenticaciÃ³n de Usuarios",
      "item": [
        {
          "name": "ğŸ” Login - Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin1@demo.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.access_token) {",
                  "        pm.collectionVariables.set('admin_token', response.access_token);",
                  "        console.log('âœ… Token Admin guardado:', response.access_token.substring(0, 50) + '...');",
                  "        console.log('ğŸ‘¤ Usuario:', response.user.name);",
                  "        console.log('ğŸ“§ Email:', response.user.email);",
                  "    }",
                  "    if (response.user && response.user.id) {",
                  "        pm.collectionVariables.set('admin_id', response.user.id);",
                  "        console.log('ğŸ’¾ ID Admin guardado:', response.user.id);",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error en login Admin:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ” Login - TÃ©cnico",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"tecnico1@demo.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.access_token) {",
                  "        pm.collectionVariables.set('tecnico_token', response.access_token);",
                  "        console.log('âœ… Token TÃ©cnico guardado:', response.access_token.substring(0, 50) + '...');",
                  "        console.log('ğŸ‘¤ Usuario:', response.user.name);",
                  "        console.log('ğŸ“§ Email:', response.user.email);",
                  "    }",
                  "    if (response.user && response.user.id) {",
                  "        pm.collectionVariables.set('tecnico_id', response.user.id);",
                  "        console.log('ğŸ’¾ ID TÃ©cnico guardado:', response.user.id);",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error en login TÃ©cnico:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ” Login - Supervisor",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"supervisor1@demo.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.access_token) {",
                  "        pm.collectionVariables.set('supervisor_token', response.access_token);",
                  "        console.log('âœ… Token Supervisor guardado:', response.access_token.substring(0, 50) + '...');",
                  "        console.log('ğŸ‘¤ Usuario:', response.user.name);",
                  "        console.log('ğŸ“§ Email:', response.user.email);",
                  "    }",
                  "    if (response.user && response.user.id) {",
                  "        pm.collectionVariables.set('supervisor_id', response.user.id);",
                  "        console.log('ğŸ’¾ ID Supervisor guardado:', response.user.id);",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error en login Supervisor:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ“‹ Verificar Usuarios del Sistema",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/users",
              "host": ["{{base_url}}"],
              "path": ["users"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ“‹ Usuarios disponibles en el sistema:');",
                  "    response.data.forEach(user => {",
                  "        console.log('   ğŸ‘¤ ' + user.name + ' (' + user.email + ') - ID: ' + user.id);",
                  "    });",
                  "} else {",
                  "    console.log('âŒ Error al obtener usuarios:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ—ï¸ FLUJO 2: Supervisor Crea Trabajo",
      "item": [
        {
          "name": "â• Crear Trabajo - Supervisor",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"titulo\": \"InstalaciÃ³n de lÃ­nea elÃ©ctrica en sector norte\",\n  \"descripcion\": \"InstalaciÃ³n completa de lÃ­nea elÃ©ctrica de media tensiÃ³n en el sector norte de la ciudad. Incluye montaje de postes, tendido de cables y conexiones.\",\n  \"observacion\": \"Requiere coordinaciÃ³n con el municipio y cierre de calles temporales\",\n  \"tecnicoAsignadoId\": \"{{tecnico_id}}\",\n  \"estado\": \"pendiente\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/trabajos",
              "host": ["{{base_url}}"],
              "path": ["trabajos"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token Supervisor:', pm.collectionVariables.get('supervisor_token').substring(0, 50) + '...');",
                  "console.log('   ID TÃ©cnico:', pm.collectionVariables.get('tecnico_id'));",
                  "",
                  "if (pm.response.code === 201) {",
                  "    const trabajo = pm.response.json();",
                  "    console.log('âœ… Trabajo creado exitosamente:');",
                  "    console.log('   ğŸ“‹ TÃ­tulo:', trabajo.titulo);",
                  "    console.log('   ğŸ†” ID:', trabajo.id);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico asignado:', trabajo.tecnicoAsignado?.name || 'No asignado');",
                  "    console.log('   ğŸ“Š Estado:', trabajo.estado);",
                  "    console.log('   ğŸ” Permisos creados:', trabajo.permisos?.length || 0);",
                  "    ",
                  "    // Guardar ID del trabajo",
                  "    pm.collectionVariables.set('trabajo_id', trabajo.id);",
                  "    ",
                  "    // Mostrar detalles de permisos",
                  "    if (trabajo.permisos && trabajo.permisos.length > 0) {",
                  "        console.log('   ğŸ“‹ Permisos creados automÃ¡ticamente:');",
                  "        trabajo.permisos.forEach((permiso, index) => {",
                  "            console.log('      ' + (index + 1) + '. ' + permiso.tipoPermiso?.nombre + ' - ' + permiso.estado);",
                  "        });",
                  "    }",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Trabajo creado y asignado exitosamente!');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al crear trabajo:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ‘ï¸ Ver Trabajo Creado",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/trabajos/{{trabajo_id}}",
              "host": ["{{base_url}}"],
              "path": ["trabajos", "{{trabajo_id}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const trabajo = pm.response.json();",
                  "    console.log('ğŸ‘ï¸ Detalles del trabajo creado:');",
                  "    console.log('   ğŸ“‹ TÃ­tulo:', trabajo.titulo);",
                  "    console.log('   ğŸ“ DescripciÃ³n:', trabajo.descripcion);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico asignado:', trabajo.tecnicoAsignado?.name || 'No asignado');",
                  "    console.log('   ğŸ“Š Estado:', trabajo.estado);",
                  "    console.log('   ğŸ“… Fecha creaciÃ³n:', trabajo.fechaCreacion);",
                  "    console.log('   ğŸ” Permisos asociados:', trabajo.permisos?.length || 0);",
                  "    ",
                  "    if (trabajo.permisos && trabajo.permisos.length > 0) {",
                  "        console.log('   ğŸ“‹ Detalles de permisos:');",
                  "        trabajo.permisos.forEach((permiso, index) => {",
                  "            console.log('      ' + (index + 1) + '. Tipo:', permiso.tipoPermiso?.nombre);",
                  "            console.log('         Estado:', permiso.estado);",
                  "            console.log('         ID:', permiso.id);",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener trabajo:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ‘¤ FLUJO 3: TÃ©cnico Ve Sus Trabajos",
      "item": [
        {
          "name": "ğŸ‘¤ Mis Trabajos - TÃ©cnico",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{tecnico_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/trabajos/mis-trabajos",
              "host": ["{{base_url}}"],
              "path": ["trabajos", "mis-trabajos"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ‘¤ Mis trabajos asignados:');",
                  "    console.log('   ğŸ“Š Total de trabajos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((trabajo, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ“‹ ' + trabajo.titulo);",
                  "            console.log('      ğŸ†” ID:', trabajo.id);",
                  "            console.log('      ğŸ“Š Estado:', trabajo.estado);",
                  "            console.log('      ğŸ” Permisos pendientes:', trabajo.permisos?.filter(p => p.estado === 'pendiente').length || 0);",
                  "            console.log('      ğŸ” Permisos totales:', trabajo.permisos?.length || 0);",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No tienes trabajos asignados');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener mis trabajos:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ“Š FLUJO 4: Ver Todos los Trabajos",
      "item": [
        {
          "name": "ğŸ“‹ Listar Todos los Trabajos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/trabajos",
              "host": ["{{base_url}}"],
              "path": ["trabajos"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ“‹ Trabajos disponibles en el sistema:');",
                  "    console.log('   ğŸ“Š Total de trabajos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((trabajo, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ“‹ ' + trabajo.titulo);",
                  "            console.log('      ğŸ†” ID:', trabajo.id);",
                  "            console.log('      ğŸ‘¤ TÃ©cnico:', trabajo.tecnicoAsignado?.name || 'No asignado');",
                  "            console.log('      ğŸ“Š Estado:', trabajo.estado);",
                  "            console.log('      ğŸ” Permisos:', trabajo.permisos?.length || 0);",
                  "            console.log('');",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener trabajos:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ­ FLUJO 5: GestiÃ³n de Roles",
      "item": [
        {
          "name": "ğŸ“‹ Listar Roles",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/roles",
              "host": ["{{base_url}}"],
              "path": ["roles"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ­ Roles disponibles en el sistema:');",
                  "    console.log('   ğŸ“Š Total de roles:', response.data?.length || 0);",
                  "    ",
                  "    if (response.data && response.data.length > 0) {",
                  "        response.data.forEach((role, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ­ ' + role.name);",
                  "            console.log('      ğŸ†” ID:', role.id);",
                  "            console.log('      ğŸ“ DescripciÃ³n:', role.description);",
                  "            console.log('      ğŸ‘¥ Usuarios:', role.users?.length || 0);",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener roles:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ” FLUJO 6: GestiÃ³n de Permisos",
      "item": [
        {
          "name": "ğŸ“‹ Listar Tipos de Permiso",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/tipos-permiso",
              "host": ["{{base_url}}"],
              "path": ["tipos-permiso"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ” Tipos de permiso disponibles:');",
                  "    console.log('   ğŸ“Š Total de tipos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((tipo, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + tipo.nombre);",
                  "            console.log('      ğŸ†” ID:', tipo.id);",
                  "            console.log('      ğŸ“ DescripciÃ³n:', tipo.descripcion);",
                  "            console.log('      ğŸ“Š Orden:', tipo.orden);",
                  "            console.log('      âœ… Activo:', tipo.activo);",
                  "            ",
                  "            // Guardar ID del primer permiso (altura) para uso posterior",
                  "            if (tipo.orden === 1) {",
                  "                pm.collectionVariables.set('permiso_altura_id', tipo.id);",
                  "                console.log('ğŸ’¾ ID Permiso Altura guardado:', tipo.id);",
                  "            }",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener tipos de permiso:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ“¸ FLUJO 7: TÃ©cnico Solicita Permiso de Altura con Imagen Real",
      "item": [
        {
          "name": "ğŸ” Obtener Permisos del Trabajo (para imagen de altura)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/permisos/trabajo/{{trabajo_id}}",
              "host": ["{{base_url}}"],
              "path": ["permisos", "trabajo", "{{trabajo_id}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ” Permisos del trabajo para imagen de altura:');",
                  "    console.log('   ğŸ“Š Total de permisos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ“Š Estado:', permiso.estado);",
                  "            ",
                  "            // Guardar ID del permiso de altura para solicitar con imagen",
                  "            if (permiso.tipoPermiso?.orden === 1) {",
                  "                pm.collectionVariables.set('permiso_altura_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Altura guardado para imagen:', permiso.id);",
                  "            }",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos del trabajo:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ“¤ TÃ©cnico Solicita Permiso de Altura con Imagen",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{tecnico_token}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "descripcion",
                  "value": "Solicito permiso de altura para trabajos en postes de 12 metros. Adjunto imagen del Ã¡rea de trabajo, equipos de seguridad verificados y zona delimitada.",
                  "type": "text"
                },
                {
                  "key": "imagen",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_altura_id}}/solicitar-con-imagen",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_altura_id}}", "solicitar-con-imagen"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token TÃ©cnico:', pm.collectionVariables.get('tecnico_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Altura:', pm.collectionVariables.get('permiso_altura_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de altura solicitado con imagen exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n:', permiso.descripcion);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    ",
                  "    if (permiso.imagenes && permiso.imagenes.length > 0) {",
                  "        console.log('   ğŸ–¼ï¸ ImÃ¡genes asociadas:');",
                  "        permiso.imagenes.forEach((imagen, index) => {",
                  "            console.log('      ' + (index + 1) + '. ğŸ“¸ ' + imagen.nombre);",
                  "            console.log('         ğŸ†” ID:', imagen.id);",
                  "            console.log('         ğŸ”— URL:', imagen.url.substring(0, 50) + '...');",
                  "            console.log('         ğŸ“Š TamaÃ±o:', imagen.tamaÃ±o + ' bytes');",
                  "            console.log('         ğŸ“‹ Tipo:', imagen.mimeType);",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No hay imÃ¡genes asociadas');",
                  "    }",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de altura solicitado con imagen! Pendiente de aprobaciÃ³n del supervisor.');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al solicitar permiso con imagen:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ‘¤ Ver Mis Permisos - TÃ©cnico",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{tecnico_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/permisos/mis-permisos",
              "host": ["{{base_url}}"],
              "path": ["permisos", "mis-permisos"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ‘¤ Mis permisos solicitados:');",
                  "    console.log('   ğŸ“Š Total de permisos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ“Š Estado:', permiso.estado);",
                  "            console.log('      ğŸ“ DescripciÃ³n:', permiso.descripcion || 'Sin descripciÃ³n');",
                  "            console.log('      ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "            console.log('      ğŸ“‹ Trabajo:', permiso.trabajo?.titulo || 'Sin trabajo');",
                  "            ",
                  "            if (permiso.imagenes && permiso.imagenes.length > 0) {",
                  "                console.log('      ğŸ–¼ï¸ ImÃ¡genes:', permiso.imagenes.length);",
                  "            }",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No tienes permisos solicitados');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener mis permisos:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "âœ… FLUJO 8: Supervisor Aprueba Permiso de Altura",
      "item": [
        {
          "name": "ğŸ“‹ Ver Permisos Pendientes - Supervisor",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/permisos/pendientes",
              "host": ["{{base_url}}"],
              "path": ["permisos", "pendientes"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ“‹ Permisos pendientes de aprobaciÃ³n:');",
                  "    console.log('   ğŸ“Š Total de permisos pendientes:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "            console.log('      ğŸ“ DescripciÃ³n:', permiso.descripcion || 'Sin descripciÃ³n');",
                  "            console.log('      ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "            console.log('      ğŸ“‹ Trabajo:', permiso.trabajo?.titulo || 'Sin trabajo');",
                  "            ",
                  "            // Guardar ID del permiso de altura para aprobar",
                  "            if (permiso.tipoPermiso?.orden === 1) {",
                  "                pm.collectionVariables.set('permiso_altura_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Altura guardado para aprobar:', permiso.id);",
                  "            }",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No hay permisos pendientes de aprobaciÃ³n');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos pendientes:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "âœ… Supervisor Aprueba Permiso de Altura",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"comentario\": \"Permiso APROBADO. Verificar que el tÃ©cnico use EPP completo (casco, arnÃ©s, botas de seguridad) y que la zona estÃ© correctamente delimitada.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_altura_id}}/aprobar",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_altura_id}}", "aprobar"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token Supervisor:', pm.collectionVariables.get('supervisor_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Altura:', pm.collectionVariables.get('permiso_altura_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de altura aprobado exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n tÃ©cnico:', permiso.descripcion);",
                  "    console.log('   ğŸ’¬ Comentario supervisor:', permiso.comentarioSupervisor);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ‘¨â€ğŸ’¼ Supervisor:', permiso.supervisor?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    console.log('   ğŸ“… Fecha respuesta:', permiso.fechaRespuesta);",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de altura aprobado! El tÃ©cnico puede proceder con el trabajo.');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al aprobar permiso:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ‘ï¸ Ver Permiso Aprobado",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_altura_id}}",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_altura_id}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('ğŸ‘ï¸ Detalles del permiso aprobado:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n tÃ©cnico:', permiso.descripcion);",
                  "    console.log('   ğŸ’¬ Comentario supervisor:', permiso.comentarioSupervisor);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ‘¨â€ğŸ’¼ Supervisor:', permiso.supervisor?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    console.log('   ğŸ“… Fecha respuesta:', permiso.fechaRespuesta);",
                  "    console.log('   ğŸ“‹ Trabajo:', permiso.trabajo?.titulo || 'Sin trabajo');",
                  "    ",
                  "    if (permiso.estado === 'aprobado') {",
                  "        console.log('ğŸ‰ Â¡Flujo completado exitosamente!');",
                  "        console.log('ğŸ’¡ El tÃ©cnico puede proceder con el trabajo de altura.');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permiso:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },

    {
      "name": "ğŸ”Œ FLUJO 10: TÃ©cnico Solicita Permiso de Enganche (DespuÃ©s de Altura)",
      "item": [
        {
          "name": "ğŸ” Obtener Permisos del Trabajo (para enganche)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/permisos/trabajo/{{trabajo_id}}",
              "host": ["{{base_url}}"],
              "path": ["permisos", "trabajo", "{{trabajo_id}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ” Permisos del trabajo para enganche:');",
                  "    console.log('   ğŸ“Š Total de permisos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ“Š Estado:', permiso.estado);",
                  "            ",
                  "            // Guardar ID del permiso de enganche (orden 2)",
                  "            if (permiso.tipoPermiso?.orden === 2) {",
                  "                pm.collectionVariables.set('permiso_enganche_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Enganche guardado:', permiso.id);",
                  "            }",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos del trabajo:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ“¤ TÃ©cnico Solicita Permiso de Enganche",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{tecnico_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"descripcion\": \"Solicito permiso de enganche para conectar equipos de alta tensiÃ³n. El permiso de altura ya fue aprobado y procedo con la conexiÃ³n elÃ©ctrica.\",\n  \"imagenUrl\": \"https://ejemplo.com/imagen-enganche.jpg\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_enganche_id}}/solicitar",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_enganche_id}}", "solicitar"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token TÃ©cnico:', pm.collectionVariables.get('tecnico_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Enganche:', pm.collectionVariables.get('permiso_enganche_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de enganche solicitado exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n:', permiso.descripcion);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de enganche solicitado! Pendiente de aprobaciÃ³n del supervisor.');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al solicitar permiso:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "âœ… FLUJO 11: Supervisor Aprueba Permiso de Enganche",
      "item": [
        {
          "name": "ğŸ“‹ Ver Permisos Pendientes - Supervisor (Enganche)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/permisos/pendientes",
              "host": ["{{base_url}}"],
              "path": ["permisos", "pendientes"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ“‹ Permisos pendientes de aprobaciÃ³n (Enganche):');",
                  "    console.log('   ğŸ“Š Total de permisos pendientes:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "            console.log('      ğŸ“ DescripciÃ³n:', permiso.descripcion || 'Sin descripciÃ³n');",
                  "            console.log('      ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "            ",
                  "            // Guardar ID del permiso de enganche para aprobar",
                  "            if (permiso.tipoPermiso?.orden === 2) {",
                  "                pm.collectionVariables.set('permiso_enganche_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Enganche guardado para aprobar:', permiso.id);",
                  "            }",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No hay permisos pendientes de aprobaciÃ³n');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos pendientes:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "âœ… Supervisor Aprueba Permiso de Enganche",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"comentario\": \"Permiso de enganche APROBADO. Verificar que la conexiÃ³n elÃ©ctrica estÃ© correctamente instalada y que todos los equipos de seguridad estÃ©n funcionando.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_enganche_id}}/aprobar",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_enganche_id}}", "aprobar"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token Supervisor:', pm.collectionVariables.get('supervisor_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Enganche:', pm.collectionVariables.get('permiso_enganche_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de enganche aprobado exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n tÃ©cnico:', permiso.descripcion);",
                  "    console.log('   ğŸ’¬ Comentario supervisor:', permiso.comentarioSupervisor);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ‘¨â€ğŸ’¼ Supervisor:', permiso.supervisor?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    console.log('   ğŸ“… Fecha respuesta:', permiso.fechaRespuesta);",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de enganche aprobado! El tÃ©cnico puede proceder con el trabajo.');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al aprobar permiso:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "ğŸ”’ FLUJO 12: TÃ©cnico Solicita Permiso de Cierre (Final)",
      "item": [
        {
          "name": "ğŸ” Obtener Permisos del Trabajo (para cierre)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/permisos/trabajo/{{trabajo_id}}",
              "host": ["{{base_url}}"],
              "path": ["permisos", "trabajo", "{{trabajo_id}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ” Permisos del trabajo para cierre:');",
                  "    console.log('   ğŸ“Š Total de permisos:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ“Š Estado:', permiso.estado);",
                  "            ",
                  "            // Guardar ID del permiso de cierre (orden 3)",
                  "            if (permiso.tipoPermiso?.orden === 3) {",
                  "                pm.collectionVariables.set('permiso_cierre_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Cierre guardado:', permiso.id);",
                  "            }",
                  "        });",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos del trabajo:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "ğŸ“¤ TÃ©cnico Solicita Permiso de Cierre",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{tecnico_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"descripcion\": \"Solicito permiso de cierre para finalizar el trabajo. Todos los permisos anteriores han sido aprobados y el trabajo estÃ¡ completado exitosamente.\",\n  \"imagenUrl\": \"https://ejemplo.com/imagen-trabajo-terminado.jpg\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_cierre_id}}/solicitar",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_cierre_id}}", "solicitar"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token TÃ©cnico:', pm.collectionVariables.get('tecnico_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Cierre:', pm.collectionVariables.get('permiso_cierre_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de cierre solicitado exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n:', permiso.descripcion);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de cierre solicitado! Pendiente de aprobaciÃ³n del supervisor.');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al solicitar permiso:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "âœ… FLUJO 13: Supervisor Aprueba Permiso de Cierre (Final)",
      "item": [
        {
          "name": "ğŸ“‹ Ver Permisos Pendientes - Supervisor (Cierre)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/permisos/pendientes",
              "host": ["{{base_url}}"],
              "path": ["permisos", "pendientes"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    console.log('ğŸ“‹ Permisos pendientes de aprobaciÃ³n (Cierre):');",
                  "    console.log('   ğŸ“Š Total de permisos pendientes:', response.length || 0);",
                  "    ",
                  "    if (response && response.length > 0) {",
                  "        response.forEach((permiso, index) => {",
                  "            console.log('   ' + (index + 1) + '. ğŸ” ' + permiso.tipoPermiso?.nombre);",
                  "            console.log('      ğŸ†” ID:', permiso.id);",
                  "            console.log('      ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "            console.log('      ğŸ“ DescripciÃ³n:', permiso.descripcion || 'Sin descripciÃ³n');",
                  "            console.log('      ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "            ",
                  "            // Guardar ID del permiso de cierre para aprobar",
                  "            if (permiso.tipoPermiso?.orden === 3) {",
                  "                pm.collectionVariables.set('permiso_cierre_id', permiso.id);",
                  "                console.log('ğŸ’¾ ID Permiso Cierre guardado para aprobar:', permiso.id);",
                  "            }",
                  "        });",
                  "    } else {",
                  "        console.log('   ğŸ“­ No hay permisos pendientes de aprobaciÃ³n');",
                  "    }",
                  "} else {",
                  "    console.log('âŒ Error al obtener permisos pendientes:', pm.response.status);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "âœ… Supervisor Aprueba Permiso de Cierre",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{supervisor_token}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"comentario\": \"Permiso de cierre APROBADO. Trabajo completado exitosamente. Verificar que toda la instalaciÃ³n estÃ© funcionando correctamente y que la zona estÃ© limpia.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/permisos/{{permiso_cierre_id}}/aprobar",
              "host": ["{{base_url}}"],
              "path": ["permisos", "{{permiso_cierre_id}}", "aprobar"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "console.log('ğŸ” Verificando datos:');",
                  "console.log('   Token Supervisor:', pm.collectionVariables.get('supervisor_token').substring(0, 50) + '...');",
                  "console.log('   ID Permiso Cierre:', pm.collectionVariables.get('permiso_cierre_id'));",
                  "",
                  "if (pm.response.code === 200) {",
                  "    const permiso = pm.response.json();",
                  "    console.log('âœ… Permiso de cierre aprobado exitosamente:');",
                  "    console.log('   ğŸ” Tipo:', permiso.tipoPermiso?.nombre);",
                  "    console.log('   ğŸ†” ID:', permiso.id);",
                  "    console.log('   ğŸ“Š Estado:', permiso.estado);",
                  "    console.log('   ğŸ“ DescripciÃ³n tÃ©cnico:', permiso.descripcion);",
                  "    console.log('   ğŸ’¬ Comentario supervisor:', permiso.comentarioSupervisor);",
                  "    console.log('   ğŸ‘¤ TÃ©cnico:', permiso.tecnico?.name || 'No asignado');",
                  "    console.log('   ğŸ‘¨â€ğŸ’¼ Supervisor:', permiso.supervisor?.name || 'No asignado');",
                  "    console.log('   ğŸ“… Fecha solicitud:', permiso.fechaSolicitud);",
                  "    console.log('   ğŸ“… Fecha respuesta:', permiso.fechaRespuesta);",
                  "    ",
                  "    console.log('ğŸ‰ Â¡Permiso de cierre aprobado! El trabajo estÃ¡ completamente terminado.');",
                  "    console.log('ğŸ Â¡FLUJO COMPLETO TERMINADO EXITOSAMENTE!');",
                  "    console.log('ğŸ“Š Resumen del flujo:');",
                  "    console.log('   âœ… Altura: Solicitado y Aprobado');",
                  "    console.log('   âœ… Enganche: Solicitado y Aprobado');",
                  "    console.log('   âœ… Cierre: Solicitado y Aprobado');",
                  "    ",
                  "} else {",
                  "    console.log('âŒ Error al aprobar permiso:', pm.response.status);",
                  "    console.log('ğŸ“„ Respuesta:', pm.response.text());",
                  "}"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
} 